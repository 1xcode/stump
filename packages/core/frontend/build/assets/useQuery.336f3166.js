import{R as n,e as p,n as l,s as v,p as S,Q as h}from"./index.c3e0d6de.js";function E(){var t=!1;return{clearReset:function(){t=!1},reset:function(){t=!0},isReset:function(){return t}}}var b=n.createContext(E()),m=function(){return n.useContext(b)};function C(t,u){var a=n.useRef(!1),f=n.useState(0),R=f[1],d=p(),i=m(),e=d.defaultQueryObserverOptions(t);e.optimisticResults=!0,e.onError&&(e.onError=l.batchCalls(e.onError)),e.onSuccess&&(e.onSuccess=l.batchCalls(e.onSuccess)),e.onSettled&&(e.onSettled=l.batchCalls(e.onSettled)),e.suspense&&(typeof e.staleTime!="number"&&(e.staleTime=1e3),e.cacheTime===0&&(e.cacheTime=1)),(e.suspense||e.useErrorBoundary)&&(i.isReset()||(e.retryOnMount=!1));var y=n.useState(function(){return new u(d,e)}),r=y[0],s=r.getOptimisticResult(e);if(n.useEffect(function(){a.current=!0,i.clearReset();var o=r.subscribe(l.batchCalls(function(){a.current&&R(function(c){return c+1})}));return r.updateResult(),function(){a.current=!1,o()}},[i,r]),n.useEffect(function(){r.setOptions(e,{listeners:!1})},[e,r]),e.suspense&&s.isLoading)throw r.fetchOptimistic(e).then(function(o){var c=o.data;e.onSuccess==null||e.onSuccess(c),e.onSettled==null||e.onSettled(c,null)}).catch(function(o){i.clearReset(),e.onError==null||e.onError(o),e.onSettled==null||e.onSettled(void 0,o)});if(s.isError&&!i.isReset()&&!s.isFetching&&v(e.suspense,e.useErrorBoundary,[s.error,r.getCurrentQuery()]))throw s.error;return e.notifyOnChangeProps==="tracked"&&(s=r.trackResult(s,e)),s}function O(t,u,a){var f=S(t,u,a);return C(f,h)}export{O as u};
